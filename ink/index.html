<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Gerador de Mistura de Tinta</title>

<style>
    body {
        background: #0e0e0e;
        color: #eaeaea;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
    }

    h1, h2 {
        margin-bottom: 10px;
    }

    .step {
        border: 1px solid #333;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        background: #151515;
    }

    /* ===== ETAPA 1 ===== */
    .step-ajuste-cor {
        transition: background 0.2s ease, color 0.2s ease;
    }

    .step-ajuste-cor input[type="range"] {
        width: 100%;
    }

    .color-preview {
        width: 100%;
        height: 120px;
        border-radius: 8px;
        margin-bottom: 10px;
        border: 1px solid #000;
    }

    label {
        font-size: 14px;
        display: block;
        margin-top: 10px;
    }

    button {
        margin-top: 15px;
        padding: 10px 16px;
        background: #c62828;
        color: #fff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }

    button:hover {
        background: #e53935;
    }

    /* ===== TABELA ===== */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }

    th, td {
        border: 1px solid #333;
        padding: 8px;
        text-align: center;
    }

    .color-sample {
        width: 60px;
        height: 30px;
        border-radius: 4px;
        border: 1px solid #000;
        margin: auto;
    }

    /* ===== IMPRESSÃO ===== */
    @media print {
        body {
            background: #fff;
            color: #000;
        }

        .step-ajuste-cor,
        button {
            display: none;
        }

        table {
            page-break-inside: avoid;
        }

        .color-sample {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }
</style>
</head>

<body>

<h1>Mistura de Tinta por Ajuste Visual</h1>

<div class="step step-ajuste-cor" id="stepAjuste">
    <h2>1️⃣ Ajuste visual da cor</h2>
    <p>Ajuste até bater com o tubo real ao lado da tela.</p>

    <div class="color-preview" id="preview"></div>

    <label>Vermelho</label>
    <input type="range" min="0" max="255" id="r" value="128">

    <label>Verde</label>
    <input type="range" min="0" max="255" id="g" value="128">

    <label>Azul</label>
    <input type="range" min="0" max="255" id="b" value="128">

    <button onclick="gerarMistura()">Gerar mistura</button>
</div>

<div class="step">
    <h2>2️⃣ Mistura sugerida</h2>
    <table id="tabela">
        <thead>
            <tr>
                <th>Cor</th>
                <th>Gotas</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    const preview = document.getElementById('preview');
    const step = document.getElementById('stepAjuste');

    const rInput = document.getElementById('r');
    const gInput = document.getElementById('g');
    const bInput = document.getElementById('b');

    function atualizarPreview() {
        const r = rInput.value;
        const g = gInput.value;
        const b = bInput.value;

        const hex = `#${(+r).toString(16).padStart(2,'0')}${(+g).toString(16).padStart(2,'0')}${(+b).toString(16).padStart(2,'0')}`;

        preview.style.background = hex;
        step.style.background = hex;
        step.style.color = getContrastColor(r, g, b);
    }

    function getContrastColor(r, g, b) {
        const luminance = (0.299*r + 0.587*g + 0.114*b) / 255;
        return luminance > 0.5 ? '#000000' : '#ffffff';
    }

    rInput.oninput = atualizarPreview;
    gInput.oninput = atualizarPreview;
    bInput.oninput = atualizarPreview;

    atualizarPreview();

    function gerarMistura() {
        const r = +rInput.value;
        const g = +gInput.value;
        const b = +bInput.value;

        const branco = Math.min(r, g, b);
        const preto = 255 - Math.max(r, g, b);

        const mistura = [
            { nome: 'Vermelho', valor: r - branco },
            { nome: 'Verde', valor: g - branco },
            { nome: 'Azul', valor: b - branco },
            { nome: 'Branco', valor: branco },
            { nome: 'Preto', valor: preto }
        ];

        const total = mistura.reduce((s, c) => s + Math.max(c.valor,0), 0);

        const tbody = document.querySelector('#tabela tbody');
        tbody.innerHTML = '';

        mistura.forEach(c => {
            if (c.valor <= 0) return;

            const gotas = Math.round((c.valor / total) * 100);

            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td><div class="color-sample" style="background:${getColorHex(c.nome)}"></div></td>
                <td>${gotas}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    function getColorHex(nome) {
        switch(nome) {
            case 'Vermelho': return '#ff0000';
            case 'Verde': return '#00ff00';
            case 'Azul': return '#0000ff';
            case 'Branco': return '#ffffff';
            case 'Preto': return '#000000';
        }
    }
</script>

</body>
</html>
